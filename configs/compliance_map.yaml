frameworks:

  EU_AI_ACT:
    clauses:
      - id: "Art9_Data_Governance"
        description: "Data governance, bias testing, dataset documentation"
        weight: 10
        any_of:
          - { module: "L3", min_score: 95 }
          - { metric: "L3.metrics.DPG", max: 0.05 }
          - { metric: "L3.metrics.EOD", max: 0.05 }

      - id: "Art13_Transparency"
        description: "Explainability & transparency of model decisions"
        weight: 10
        any_of:
          - { module: "L4", min_score: 90 }
          - { metric: "L4.metrics.deletion_drop", gte: 0.15 }
          - { metric: "L4.metrics.stability_tau", gte: 0.85 }

      - id: "Art14_Human_Oversight"
        description: "Human oversight via dashboards / overrides"
        weight: 8
        any_of:
          - { exists: "AGG" }

      - id: "Art15_Robustness"
        description: "Monitoring, logging, operational robustness"
        weight: 8
        any_of:
          - { module: "L5", min_score: 85 }
          - { metric: "L5.metrics.logging_coverage", gte: 0.95 }
          - { metric: "L5.metrics.alert_latency_h", lte: 1.0 }

  GDPR:
    clauses:
      - id: "Art5_Data_Principles"
        description: "Lawfulness, fairness, transparency; data minimization & retention"
        weight: 10
        any_of:
          - { module: "L2", min_score: 90 }
      - id: "Art22_Automated_Decisions"
        description: "Right to meaningful information about logic"
        weight: 8
        any_of:
          - { module: "L4", min_score: 90 }

  HIPAA:
    clauses:
      - id: "Security_Integrity"
        description: "Access logging & integrity controls"
        weight: 6
        any_of:
          - { metric: "L5.metrics.logging_coverage", gte: 0.95 }

  ISO_IEC_42001:
    clauses:
      - id: "AI_Risk_Management"
        description: "Systematic AI risk management & governance"
        weight: 8
        any_of:
          - { module: "AGG", min_score: 88 }
          - { exists: "AGG" }

  SaMD:
    clauses:
      - id: "Quality_Management"
        description: "QMS, traceability, change control"
        weight: 6
        any_of:
          - { exists: "L1" }

  ISO_13485:
    clauses:
      - id: "Design_Control"
        description: "Medical device design control requirements and procedures"
        weight: 10
        any_of:
          - { module: "L1", min_score: 85 }
          - { module: "AGG", min_score: 85 }

      - id: "Risk_Management"
        description: "Medical device risk management throughout lifecycle"
        weight: 9
        any_of:
          - { module: "L1", min_score: 80 }
          - { exists: "L1" }

      - id: "Documentation_Control"
        description: "Document control, records management, traceability"
        weight: 8
        any_of:
          - { exists: "L1" }
          - { module: "L5", min_score: 85 }

  ISO_14971:
    clauses:
      - id: "Risk_Analysis"
        description: "Risk analysis and evaluation for medical devices"
        weight: 10
        any_of:
          - { module: "L1", min_score: 85 }
          - { module: "AGG", min_score: 80 }

      - id: "Risk_Control"
        description: "Risk control measures and residual risk evaluation"
        weight: 9
        any_of:
          - { module: "L1", min_score: 85 }
          - { exists: "L1" }

      - id: "Risk_Monitoring"
        description: "Post-production information and risk monitoring"
        weight: 8
        any_of:
          - { module: "L5", min_score: 85 }
          - { metric: "L5.metrics.logging_coverage", gte: 0.90 }

  ISO_27001:
    clauses:
      - id: "Access_Control"
        description: "Information access control and user rights management"
        weight: 10
        any_of:
          - { module: "L5", min_score: 85 }
          - { metric: "L5.metrics.logging_coverage", gte: 0.95 }

      - id: "Cryptography"
        description: "Cryptographic controls for data protection"
        weight: 10
        any_of:
          - { module: "L2", min_score: 90 }
          - { metric: "L2.metrics.encryption_coverage", gte: 0.95 }

      - id: "Incident_Management"
        description: "Information security incident handling and response"
        weight: 9
        any_of:
          - { exists: "L5" }
          - { module: "L5", min_score: 80 }

  ISO_27799:
    clauses:
      - id: "Health_Data_Security"
        description: "Health information security controls and safeguards"
        weight: 10
        any_of:
          - { module: "L2", min_score: 92 }
          - { module: "L5", min_score: 85 }

      - id: "Privacy_by_Design"
        description: "Privacy by design for health data systems"
        weight: 10
        any_of:
          - { module: "L2", min_score: 90 }
          - { module: "L3", min_score: 85 }

      - id: "Patient_Consent"
        description: "Patient consent management and data subject rights"
        weight: 8
        any_of:
          - { exists: "L1" }
          - { module: "L4", min_score: 85 }

  IEC_62304:
    clauses:
      - id: "Software_Development"
        description: "Software development planning and implementation"
        weight: 10
        any_of:
          - { exists: "L1" }
          - { module: "L1", min_score: 85 }

      - id: "Software_Testing"
        description: "Software testing, verification, and validation"
        weight: 10
        any_of:
          - { exists: "L5" }
          - { module: "L5", min_score: 85 }

      - id: "Software_Maintenance"
        description: "Software maintenance and release management procedures"
        weight: 9
        any_of:
          - { exists: "L5" }
          - { module: "L5", min_score: 80 }

      - id: "Problem_Resolution"
        description: "Problem resolution and change management controls"
        weight: 8
        any_of:
          - { exists: "L5" }
          - { module: "L1", min_score: 75 }
